<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Noor AI - Islamic Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Amiri&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(16, 185, 129, 0.2); }
        .arabic { font-family: 'Amiri', serif; font-size: 1.4rem; line-height: 2.2; }
        .tab-content { display: none; height: calc(100vh - 160px); overflow-y: auto; }
        .tab-content.active { display: block; }
        @keyframes pulse-emerald { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(16, 185, 129, 0); } 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
        .tasbih-btn:active { transform: scale(0.92); transition: transform 0.1s; }
        .loading-dot { animation: bounce 1.4s infinite ease-in-out; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #10b981; border-radius: 10px; }
    </style>
</head>
<body class="flex justify-center">

    <div class="w-full max-w-md h-screen relative flex flex-col shadow-2xl border-x border-emerald-900/30">
        
        <!-- Header -->
        <header class="p-6 flex items-center justify-between z-20 bg-slate-950/50">
            <div>
                <h1 class="text-2xl font-extrabold bg-gradient-to-r from-emerald-400 to-teal-300 bg-clip-text text-transparent">NOOR AI</h1>
                <p class="text-[10px] tracking-[0.2em] text-emerald-500 font-bold uppercase">Divine Guidance</p>
            </div>
            <div id="connection-status" class="w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,1)]"></div>
        </header>

        <!-- Home Tab -->
        <div id="home" class="tab-content active p-6 space-y-6">
            <div class="glass p-6 rounded-3xl relative overflow-hidden">
                <div class="absolute -top-10 -right-10 w-32 h-32 bg-emerald-500/10 rounded-full blur-3xl"></div>
                <h3 class="text-emerald-400 text-sm font-bold flex items-center mb-3">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20"><path d="M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0z"></path></svg>
                    Daily Wisdom
                </h3>
                <p class="arabic text-right mb-4">ŸÅŸéÿßÿ∞ŸíŸÉŸèÿ±ŸèŸàŸÜŸêŸä ÿ£Ÿéÿ∞ŸíŸÉŸèÿ±ŸíŸÉŸèŸÖŸí</p>
                <p class="italic text-slate-300">"So remember Me; I will remember you."</p>
                <p class="text-xs text-emerald-600 mt-2">‚Äî Surah Al-Baqarah 2:152</p>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <button onclick="switchTab('chat')" class="glass p-4 rounded-2xl flex flex-col items-center hover:bg-emerald-900/20 transition-all border-emerald-500/20">
                    <span class="text-2xl mb-1">üí¨</span>
                    <span class="text-xs font-bold text-slate-400">Ask AI</span>
                </button>
                <button onclick="switchTab('tasbih')" class="glass p-4 rounded-2xl flex flex-col items-center hover:bg-emerald-900/20 transition-all border-emerald-500/20">
                    <span class="text-2xl mb-1">üìø</span>
                    <span class="text-xs font-bold text-slate-400">Tasbih</span>
                </button>
            </div>

            <div class="space-y-3">
                <h4 class="text-xs font-bold text-slate-500 uppercase tracking-widest px-1">Quick Actions</h4>
                <div onclick="askAI('Dua for peace of mind')" class="glass p-4 rounded-2xl flex justify-between items-center cursor-pointer group hover:border-emerald-500/50">
                    <span class="text-sm">Peace of Mind</span>
                    <span class="text-emerald-500 opacity-0 group-hover:opacity-100 transition-all">‚Üí</span>
                </div>
                <div onclick="askAI('Sunnah of sleeping')" class="glass p-4 rounded-2xl flex justify-between items-center cursor-pointer group hover:border-emerald-500/50">
                    <span class="text-sm">Sleeping Sunnah</span>
                    <span class="text-emerald-500 opacity-0 group-hover:opacity-100 transition-all">‚Üí</span>
                </div>
            </div>
        </div>

        <!-- Chat Tab -->
        <div id="chat" class="tab-content flex flex-col p-4">
            <div id="chat-messages" class="flex-1 space-y-4 pb-20">
                <div class="flex justify-start">
                    <div class="glass p-4 rounded-2xl rounded-bl-none max-w-[85%] text-sm leading-relaxed border-none">
                        Assalamu Alaikum! I am Noor, your AI guide. Ask me anything about Islam.
                    </div>
                </div>
            </div>
            
            <div class="absolute bottom-24 left-4 right-4 z-30">
                <div class="glass rounded-full flex items-center p-1 shadow-2xl">
                    <input id="chat-input" type="text" placeholder="Ask a question..." class="flex-1 bg-transparent px-5 py-3 text-sm outline-none">
                    <button onclick="sendMessage()" class="bg-emerald-500 text-slate-950 p-3 rounded-full hover:bg-emerald-400 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Tasbih Tab -->
        <div id="tasbih" class="tab-content p-6 flex flex-col items-center justify-center space-y-12">
            <div class="text-center">
                <h2 class="text-3xl font-black text-white">DHIKR</h2>
                <p class="text-emerald-500 text-xs tracking-widest font-bold">Praise Allah</p>
            </div>
            
            <button onclick="countTasbih()" class="tasbih-btn w-64 h-64 rounded-full glass border-[12px] border-emerald-500/10 flex flex-col items-center justify-center relative shadow-[0_0_50px_rgba(16,185,129,0.1)]">
                <div class="absolute inset-0 rounded-full border border-dashed border-emerald-500/20 animate-[spin_10s_linear_infinite]"></div>
                <span id="tasbih-display" class="text-7xl font-black text-white">0</span>
                <span id="tasbih-phrase" class="text-[10px] text-emerald-500 font-bold mt-2 uppercase tracking-widest">SubhanAllah</span>
            </button>

            <button onclick="resetTasbih()" class="text-slate-500 text-xs font-bold uppercase tracking-widest border-b border-transparent hover:border-slate-500 transition-all">Reset Cycle</button>
        </div>

        <!-- Bottom Nav -->
        <nav class="absolute bottom-0 left-0 right-0 h-20 glass border-t border-emerald-900/30 flex items-center justify-around z-40 px-6">
            <button onclick="switchTab('home')" class="nav-btn text-emerald-500 flex flex-col items-center" id="nav-home">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
            </button>
            <button onclick="switchTab('chat')" class="nav-btn text-slate-500 flex flex-col items-center" id="nav-chat">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7z"></path></svg>
            </button>
            <button onclick="switchTab('tasbih')" class="nav-btn text-slate-500 flex flex-col items-center" id="nav-tasbih">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg>
            </button>
        </nav>
    </div>

    <script>
        const apiKey = ""; // Gemini API Key
        let count = parseInt(localStorage.getItem('noor_tasbih')) || 0;
        let phrases = ["SubhanAllah", "Alhamdulillah", "Allahu Akbar", "La ilaha illallah"];
        let phraseIndex = 0;

        // Initialize UI
        document.getElementById('tasbih-display').innerText = count;

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.replace('text-emerald-500', 'text-slate-500'));
            
            document.getElementById(tabId).classList.add('active');
            document.getElementById('nav-' + tabId).classList.replace('text-slate-500', 'text-emerald-500');
        }

        function countTasbih() {
            count++;
            if (count % 33 === 0) {
                phraseIndex = (phraseIndex + 1) % phrases.length;
                document.getElementById('tasbih-phrase').innerText = phrases[phraseIndex];
                if (navigator.vibrate) navigator.vibrate(50);
            }
            document.getElementById('tasbih-display').innerText = count;
            localStorage.setItem('noor_tasbih', count);
        }

        function resetTasbih() {
            count = 0;
            document.getElementById('tasbih-display').innerText = 0;
            localStorage.setItem('noor_tasbih', 0);
        }

        function addMessage(role, text) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} animate-in slide-in-from-bottom-2 duration-300`;
            
            const inner = document.createElement('div');
            inner.className = `p-4 rounded-3xl max-w-[85%] text-sm leading-relaxed shadow-lg ${
                role === 'user' 
                ? 'bg-emerald-600 text-white rounded-br-none' 
                : 'glass text-slate-200 rounded-bl-none border-none'
            }`;
            inner.innerText = text;
            
            div.appendChild(inner);
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        async function askAI(query) {
            switchTab('chat');
            document.getElementById('chat-input').value = query;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if (!text) return;

            addMessage('user', text);
            input.value = '';

            // Show Loading
            const loaderId = 'loader-' + Date.now();
            const loaderDiv = document.createElement('div');
            loaderDiv.id = loaderId;
            loaderDiv.className = 'flex justify-start';
            loaderDiv.innerHTML = `<div class="glass p-4 rounded-3xl rounded-bl-none flex space-x-1">
                <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full loading-dot"></div>
                <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full loading-dot" style="animation-delay: 0.2s"></div>
                <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full loading-dot" style="animation-delay: 0.4s"></div>
            </div>`;
            document.getElementById('chat-messages').appendChild(loaderDiv);

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: text }] }],
                        systemInstruction: { parts: [{ text: "You are Noor, a wise Islamic assistant. Keep answers brief, helpful, and based on Quran/Sunnah." }] }
                    })
                });

                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;
                
                document.getElementById(loaderId).remove();
                addMessage('assistant', aiText);
            } catch (error) {
                document.getElementById(loaderId).remove();
                addMessage('assistant', "I'm having trouble connecting right now. Please try again later.");
            }
        }

        // Enter key to send
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>
